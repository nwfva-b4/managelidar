---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/README-",
  out.width = "100%"
)
```

# managelidar

<!-- badges: start -->

<!-- badges: end -->

The goal of managelidar is to facilitate the handling and management of lidar data files (`*.las/laz/copc`). 
Its's main purpose is to convert new incoming data to data with certain quality standards. Further, it provides functions to facilitate the quality check of incoming ALS data. 
`managelidar` builds on top of R-packages {[lidR](https://github.com/r-lidar/lidR)} and {[lasR](https://github.com/r-lidar/lasR)}. It is designed to work with any number and combination of folders, LASfiles and Virtual Point Clouds (VPC) and to read as little data as necessary. Most functions read metadata from VPCs which are efficiently created by lasR in the background if necessary. 
If this is not possible metadata is read from LASheaders via lidR which is a little slower but still pretty fast. Only some functions (e.g. `get_summary()`) require actual point cloud data to be read, this may take much longer. To enhance processing speed the functions run in parallel (via {[mirai](https://github.com/r-lib/mirai)}) if they are applied on a larger collection of files. 

## Installation

You can install the development version of {[managelidar](https://github.com/nwfva-b4/managelidar)} from [GitHub](https://github.com/) with:

``` r
# install.packages("pak")
pak::pak("nwfva-b4/managelidar")
```

Most functions depend on the {[lasR](https://github.com/r-lidar/lasR)} package (version >= 0.14.1) which is hosted at https://r-lidar.r-universe.dev/lasR. 
As it is not available via CRAN you have to manually install it in advance with:

``` r
# Install lasR in R:
install.packages("lasR", repos = c("https://r-lidar.r-universe.dev", "https://cran.r-project.org"))
```

## Example

Just some basic examples for package usage.

```{r examples}
library(managelidar)

# create various valid input paths
folder <- system.file("extdata", package = "managelidar")
las_files <- list.files(folder, full.names = T, pattern = "*20240327.laz")
las_file <- list.files(folder, full.names = T, pattern = "*20230904.laz")
vpc_file <- system.file("extdata/sample.vpc", package = "managelidar")
vpc_obj <- yyjsonr::read_json_file(vpc_file)
mixed <- c(folder, las_file)

paths <- list(folder, las_files, las_file, vpc_file, vpc_obj, mixed)


# get the Coordinate Reference System for all types of input
lapply(paths, get_crs)

# get the extent (bbox) from LASfiles
get_spatial_extent(las_files)

# get names of files intersecting an extent
las_files |>
  filter_spatial(c(547900, 5724900, 548100, 5724900)) |>
  get_names()

# combine with temporal filter on multi-temporal data
c(las_files, las_file) |>
  filter_temporal("2024-03") |>
  filter_spatial(c(547900, 5724900, 548100, 5724900)) |>
  get_names()
```


